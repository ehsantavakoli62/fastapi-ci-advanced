from flask import Flask, request, jsonify
from flask_cors import CORS, cross_origin

app = Flask(__name__)

# --- Настройка CORS через декоратор ---
# Разрешаем только GET и POST, origin выбран example.com, разрешенный кастомный хедер X-My-Fancy-Header
@app.route("/cors_test", methods=["GET", "POST"])
@cross_origin(
    origins="https://example.com",
    methods=["GET", "POST"],
    allow_headers=["X-My-Fancy-Header"]
)
def cors_test():
    if request.method == "GET":
        return jsonify({"message": "GET request successful"})
    elif request.method == "POST":
        data = request.json or {}
        return jsonify({"message": "POST request successful", "data_received": data})

if __name__ == "__main__":
    app.run(debug=True)
