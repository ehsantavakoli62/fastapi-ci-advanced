#  Задача 5. Максимальное число

from flask import Flask, escape
from typing import List, Union

# Create an instance of the Flask application
# یک نمونه از برنامه Flask ایجاد کنید
app = Flask(__name__)

@app.route('/max_number/<path:numbers_str>')
def max_number(numbers_str: str) -> str:
    """
    Finds the maximum number from a slash-separated list of numbers
    provided in the URL path.
    Returns the maximum number formatted in HTML, or an error message
    if invalid input is provided.
    
    حداکثر عدد را از لیستی از اعداد جدا شده با اسلش که در مسیر URL ارائه شده است، پیدا می‌کند.
    حداکثر عدد را به صورت HTML قالب‌بندی شده یا پیام خطا
    در صورت ارائه ورودی نامعتبر برمی‌گرداند.

    Args:
        numbers_str (str): A string containing slash-separated numbers (e.g., "10/2/9/1").
        یک رشته حاوی اعداد جدا شده با اسلش (مانند "10/2/9/1").

    Returns:
        str: An HTML-formatted string displaying the maximum number or an error.
        یک رشته HTML-فرمت شده که حداکثر عدد یا خطا را نمایش می‌دهد.
    """
    number_strings: List[str] = numbers_str.split('/')
    parsed_numbers: List[Union[int, float]] = []
    
    for s_num in number_strings:
        try:
            # Try converting to float first to handle decimals, then int if no decimal
            # ابتدا سعی کنید به float تبدیل کنید تا اعشار را مدیریت کنید، سپس اگر اعشار نبود به int تبدیل کنید
            if '.' in s_num:
                parsed_numbers.append(float(s_num))
            else:
                parsed_numbers.append(int(s_num))
        except ValueError:
            # If any part is not a valid number, return an error
            # اگر هر قسمتی یک عدد معتبر نباشد، یک خطا برگردانید
            return f"<h1>Error: Invalid input '{escape(s_num)}'. Please provide only numbers.</h1>"
            # خطا: ورودی نامعتبر '{escape(s_num)}'. لطفاً فقط اعداد را ارائه دهید.

    if not parsed_numbers:
        return "<h1>Error: No numbers provided.</h1>"
        # خطا: هیچ عددی ارائه نشده است.

    max_val = max(parsed_numbers)
    # The problem example uses <i> for italic, so we will use it.
    # مثال مسئله از <i> برای ایتالیک استفاده می‌کند، بنابراین ما از آن استفاده خواهیم کرد.
    return f"Максимальное переданное число <i>{max_val}</i>"
    # "Maximum transmitted number <i>{max_val}</i>"

if __name__ == '__main__':
    # Run the Flask application in debug mode / برنامه Flask را در حالت اشکال‌زدایی اجرا کنید
    # To test:
    # http://127.0.0.1:5000/max_number/10/2/9/1
    # http://127.0.0.1:5000/max_number/1/1/1/1/1/1/1/2
    # http://127.0.0.1:5000/max_number/-5/0/10/-20
    # http://127.0.0.1:5000/max_number/3.14/2.71/1.618
    # http://127.0.0.1:5000/max_number/hello/world
    # http://127.0.0.1:5000/max_number/
    app.run(debug=True)
