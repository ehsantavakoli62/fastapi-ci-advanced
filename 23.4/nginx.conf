# nginx.conf (فرض بر این است که در یک بلاک server قرار می‌گیرد)

server {
    listen 80;
    server_name localhost;

    # مسیر روت اصلی (WSGI Application)
    location / {
        # اتصال به سرور WSGI/Gunicorn (فرض می‌کنیم روی پورت 8000 است)
        proxy_pass http://127.0.0.1:8000;
        
        # --- حل تمرین ۳: افزایش تایم‌اوت ---
        # پارامتر رسمی در Nginx برای افزایش تایم‌اوت پاسخ از سرور پشتی
        proxy_read_timeout 305s;  # 300 ثانیه + margin (به جای 60 ثانیه پیش‌فرض)
        proxy_connect_timeout 305s;
        proxy_send_timeout 305s;
        
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    
    # --- حل تمرین ۲: راه‌اندازی استاتیک ---
    location /static/ {
        # مسیر فیزیکی فایل‌های استاتیک
        alias /path/to/wsgi_project/static/; # این مسیر را باید با مسیر واقعی پروژه خود جایگزین کنید!
        expires 30d; # کش کردن فایل‌های استاتیک به مدت ۳۰ روز
        access_log off;
    }
}
